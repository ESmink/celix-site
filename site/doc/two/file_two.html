<!DOCTYPE html> 
<html lang="en">
<head>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at

       http://www.apache.org/licenses/LICENSE- 2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="/import/style.css" rel="stylesheet">
<link href="/import/friendly.css" rel="stylesheet">
<!--page info-->
<title>Welcome to Apache Celix</title>
<meta name="description" content="">
<meta name="author" content="me">
</head>
<body>
<div id="imgbackground"></div>
<nav class = "shadowed">
	<a href="/"><img class="shadowed" src="/media/celix.png"></a>
	<div id="mobmenu">
	<select class="mobbutton" onchange="if (this.value) window.location.href=this.value">
		<option value="">navigate</option>
		<option value="/">Home</option>
		<option value="/doc/">Documentation</option>
		<option value="/downloads.html">Downloads</option>
		<optgroup label="Community">
			<option value="/contributing.html">Contributing</option>
			<option value="/boardreports.html">Board Reports</option>
			<option value="/releasing.html">Releasing</option>
		</optgroup>
		<optgroup label="Support">
			<option value="/mailinglist.html">Mailing List</option>
			<option value="/issuetracking.html">Issue Tracking</option>
		</optgroup>
		<optgroup label="ASF">
			<option value="http://www.apache.org/">ASF Home</option>
			<option value="http://www.apache.org/foundation/how-it-works.html">How it works</option>
			<option value="http://www.apache.org/licenses/">License</option>
			<option value="http://www.apache.org/foundation/sponsorship.html">Sponsorship</option>
			<option value="http://www.apache.org/foundation/thanks.html">Thanks</option>
			<option value="http://www.apache.org/security">Security</option>
		</optgroup>
	</select>
	<div id="dropmenu" class="shadowed">
		<a href="/"><div class="dropbutton">
			Home
		</div></a><a href="/doc/"><div class="dropbutton">
			Documentation
		</div></a><a href="/downloads.html"><div class="dropbutton">
			Download
		</div></a><div class="dropdown">
			<div class="dropbutton">Community<div class="triangle"></div></div>
			<div class="dropdown-content">
				<a href="/contributing.html">Contributing</a>
				<a href="/boardreports.html">Board Reports</a>
				<a href="/releasing.html">Releasing</a>
			</div>
		</div><div class="dropdown">
			<div class="dropbutton">Support<div class="triangle"></div></div>
			<div class="dropdown-content">
				<a href="/mailinglist.html">Mailing List</a>
				<a href="/issuetracking.html">Issue Tracking</a>
			</div>
		</div><div class="dropdown">
			<div class="dropbutton">ASF<div class="triangle"></div></div>
			<div class="dropdown-content">
				<a href="http://www.apache.org/">ASF Home</a>
				<a href="http://www.apache.org/foundation/how-it-works.html">How it works</a>
				<a href="http://www.apache.org/licenses/">License</a>
				<a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
				<a href="http://www.apache.org/foundation/thanks.html">Thanks</a>
				<a href="http://www.apache.org/security">Security</a>
			</div>
		</div>
	</div>
	</div>
</nav>
<a href="https://github.com/apache/celix">
			<img class="GHImg shadowed" src="/media/forkmeongithub.png" alt="Fork me on GitHub"
			data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png">
			<img class="GHImgSmall shadowed" src="/media/forkmesmall.png" alt="Fork me on GitHub">
</a>
<a href="http://apache.org/">
			<img id="APbig" class="logoAP shadowed" src="/media/Apache_full.svg">
			<img id="APsmall" class="logoAP shadowed" src="/media/Apache_Feather.svg">
</a>
<div class="spacer">
<div id=docTable><table>
	<tr><th>one</th></tr>
	<tr><td><a href=/doc/index.html>main</a></td></tr>
	<tr><td><a href=/doc/one/file_one.html>file one</a></td></tr>
	<tr><th>two</th></tr>
	<tr><td><a href=/doc/two/file_two.html>file two</a></td></tr>
	<tr><td><a href=/doc/two/file_three.html>file three</a></td></tr>
</table></div>
<div id=docContent>
<h1>Apache Celix - Getting Started Guide: Creating a Simple Bundle</h1>

<h2>Intro</h2>

<p>This page is intended for first time users of Apache Celix. It should guide you through building &amp; installing Apache Celix, setting up a new project, creating your first bundle, setting up the project for use with Eclipse project and finally running and debugging your bundle directly from eclipse workspace. </p>

<p>If there are any uncertainties or question, don't hesitate to ask your questions in the <a href="https://celix.apache.org/support/mailinglist.html">Apache Celix mailing</a>.</p>

<h2>Prerequisite</h2>

<p>Some experience with a command line interface (xterm) is expected to be able to follow this guide. </p>

<h2>Building and Installing</h2>

<p>For Apache Celix see <a href="../building/file_three.html">Building And Installing</a></p>

<h2>Installing Eclipse CDT</h2>

<p>Download the latest eclipse CDT at <a href="http://www.eclipse.org">http://www.eclipse.org</a> and install it on your system. For more information on how the install eclipse on your system consult the eclipse documentation. For this getting started guide the luna version of eclipse was used (<a href="http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/luna/R/eclipse-cpp-luna-R-linux-gtk-x86_64.tar.gz">linux</a> <a href="http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/luna/R/eclipse-cpp-luna-R-macosx-cocoa-x86_64.tar.gz">mac</a>).</p>

<h2>Apache Celix Bundle project</h2>

<p>Now that Apache Celix and Eclipse is installed, we are ready to create a new Apache Celix Bundle project.<br />
CMake is used as build tool for Apache Celix projects.</p>

<p>To setup of the project, first create a new project dir to work in:</p>

<div class="codehilite"><pre><span></span><code><span class="c1">#Create a new workspace to work in, e.g:</span>
mkdir <span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/workspace
<span class="nb">export</span> <span class="nv">WS</span><span class="o">=</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span>/workspace

mkdir <span class="si">${</span><span class="nv">WS</span><span class="si">}</span>/myproject
<span class="nb">cd</span> <span class="si">${</span><span class="nv">WS</span><span class="si">}</span>/myproject
</code></pre></div>

<p>Then create a CMakeLists.txt file - the makefile variant of CMake -in project root directory:</p>

<div class="codehilite"><pre><span></span><code><span class="c">#${WS}/myproject/CMakeLists.txt</span>

<span class="c">#Part 1. setup project</span>
<span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span> <span class="s">3.4</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">myproject</span> <span class="s">C</span> <span class="s">CXX</span><span class="p">)</span>

<span class="c">#Part 2. setup compilers</span>
<span class="nb">SET</span><span class="p">(</span><span class="s">CMAKE_C_FLAGS</span> <span class="s2">&quot;-D_GNU_SOURCE -std=gnu99 -Wall -Werror -fPIC ${CMAKE_C_FLAGS}&quot;</span><span class="p">)</span>
<span class="nb">SET</span><span class="p">(</span><span class="s">CMAKE_C_FLAGS_DEBUG</span> <span class="s2">&quot;-g -DDEBUG&quot;</span><span class="p">)</span>
<span class="nb">SET</span><span class="p">(</span><span class="s">CMAKE_CXX_FLAGS</span> <span class="s2">&quot;-std=c++11 ${CMAKE_CXX_FLAGS}&quot;</span><span class="p">)</span>
<span class="nb">SET</span><span class="p">(</span><span class="s">CMAKE_CXX_FLAGS_DEBUG</span> <span class="s2">&quot;-g -DDEBUG&quot;</span><span class="p">)</span>

<span class="c">#Part 3. Setup Celix cmake files, include paths, libraries and library paths</span>
<span class="c">#Note. If celix is not installed in /usr/local dir, change the location accordingly.</span>
<span class="nb">set</span><span class="p">(</span><span class="s">CMAKE_MODULE_PATH</span>  <span class="o">${</span><span class="nv">CMAKE_MODULE_PATH</span><span class="o">}</span> <span class="s2">&quot;/usr/local/share/celix/cmake/modules&quot;</span><span class="p">)</span>
<span class="nb">find_package</span><span class="p">(</span><span class="s">CELIX</span> <span class="s">REQUIRED</span><span class="p">)</span>
<span class="nb">include_directories</span><span class="p">(</span><span class="o">${</span><span class="nv">CELIX_INCLUDE_DIRS</span><span class="o">}</span><span class="p">)</span>

<span class="c">#Part 4. Choose C, C++ or both</span>
<span class="nb">add_subdirectory</span><span class="p">(</span><span class="s">bundles/hello_world</span><span class="p">)</span> <span class="c">#C</span>
<span class="nb">add_subdirectory</span><span class="p">(</span><span class="s">bundles/HelloWorld</span><span class="p">)</span> <span class="c">#C++</span>
</code></pre></div>

<p>This CMakeLists.txt file, sets up the following:</p>

<ul>
<li>Part 1<br />
<ul><br />
<li>The minimum cmake version required. </li><br />
<li>The project name</li><br />
<li>The type of source files to expect, in this case C and C++.</li><br />
</ul></li>
<li>Part 2<br />
<ul><br />
<li>Setup the compilers. c99 for C and C++11 for C++</li><br />
</ul></li>
<li>Part 3<br />
<ul><br />
<li>The Celix package should be searched, configured and that the Celix package is required. </li><br />
<li>For all build targets in this CMakeLists.txt file or any sub directory CMakeLists.txt files the Apache Celix headers directory should be included.</li><br />
</ul></li>
<li>Part 4<br />
<ul><br />
<li>The CMakelists.txt file in the subdirectory bundles/hello_world and/or bundles/HelloWorld should also be processed.</li><br />
</ul></li>
</ul>

<p>It is a good practice to create a separate CMakeLists.txt file for every bundle you want to build. For the hello<em>world bundle a CMakeLists.txt file should be created in the bundles/hello</em>world sub directory.</p>

<p>Create the sub directory:</p>

<div class="codehilite"><pre><span></span><code><span class="c">#Create directory structure for the hello_world bundles</span>
<span class="err">cd</span> <span class="err">${WS}/myproject</span>
<span class="err">mkdir</span> <span class="err">-p</span> <span class="err">bundles/hello_world/private/src</span>
<span class="err">mkdir</span> <span class="err">-p</span> <span class="err">bundles/HelloWorld/private/src</span>
<span class="err">mkdir</span> <span class="err">-p</span> <span class="err">bundles/HelloWorld/private/include</span>
</code></pre></div>

<p>And add the following CMakeLists.txt file for the C Bundle:</p>

<div class="codehilite"><pre><span></span><code><span class="c">#${WS}/myproject/bundles/hello_world/CMakeLists.txt</span>

<span class="nb">add_bundle</span><span class="p">(</span><span class="s">hello_world</span>
    <span class="s">VERSION</span> <span class="s">1.0.0</span>
    <span class="s">SOURCES</span>
        <span class="s">private/src/hello_world_activator.c</span>
<span class="p">)</span>   

<span class="nb">if</span><span class="p">(</span><span class="s">APPLE</span><span class="p">)</span>
    <span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">hello_world</span> <span class="o">${</span><span class="nv">CELIX_LIBRARIES</span><span class="o">}</span> <span class="s">-Wl,-all_load</span> <span class="o">${</span><span class="nv">CELIX_DM_STATIC_LIB</span><span class="o">}</span><span class="p">)</span>
<span class="nb">else</span><span class="p">()</span>  
    <span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">hello_world</span> <span class="s">-Wl,--no-undefined</span> <span class="s">-Wl,--whole-archive</span> <span class="o">${</span><span class="nv">CELIX_DM_STATIC_LIB</span><span class="o">}</span> <span class="s">-Wl,--no-whole-archive</span> <span class="o">${</span><span class="nv">CELIX_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
</code></pre></div>

<p>And/or the following CMakeLists.txt for the C++ bundle:</p>

<div class="codehilite"><pre><span></span><code><span class="c">#${WS}/myproject/bundles/HelloWorld/CMakeLists.txt</span>

<span class="nb">include_directories</span><span class="p">(</span>
    <span class="s">private/include</span>
<span class="p">)</span>

<span class="nb">add_bundle</span><span class="p">(</span><span class="s">HelloWorld</span>
    <span class="s">VERSION</span> <span class="s">1.0.0</span>
    <span class="s">SOURCES</span>
        <span class="s">private/src/HelloWorldActivator.cc</span>
<span class="p">)</span>

<span class="nb">IF</span><span class="p">(</span><span class="s">APPLE</span><span class="p">)</span>
    <span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">HelloWorld</span> <span class="o">${</span><span class="nv">CELIX_LIBRARIES</span><span class="o">}</span> <span class="s">-Wl,-all_load</span> <span class="o">${</span><span class="nv">CELIX_DM_CXX_STATIC_LIB</span><span class="o">}</span><span class="p">)</span>
<span class="nb">else</span><span class="p">()</span>
    <span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">HelloWorld</span> <span class="s">-Wl,--no-undefined</span> <span class="s">-Wl,--whole-archive</span> <span class="o">${</span><span class="nv">CELIX_DM_CXX_STATIC_LIB</span><span class="o">}</span> <span class="s">-Wl,--no-whole-archive</span> <span class="o">${</span><span class="nv">CELIX_LIBRARIES</span><span class="o">}</span><span class="p">)</span>
<span class="nb">endif</span><span class="p">()</span>
</code></pre></div>

<p>These CMakeLists.txt files declare that the bundles should be build based on the build result (shared library) of the declared sources (in this case the <code>private/src/hello_world_activator.c</code> or <code>private/src/HelloWorldActivator.cc</code> source).<br />
The add_bundle function is an Apache Celix specific CMake extension.<br />
The library used for the bundle will also be linked against the dependency manager static library. </p>

<p>The Celix framework will install the bundle, load the bundle shared library and call the bundle activator entry symbols. These entries need to be programmed by the user.<br />
Note that in these examples we use the dependency manager libraries (C and C++ version) instead of developing a "vanilla" bundle activator;<br />
The dependency manager uses a higher abstraction and is more simple to understand and maintain, but not part of the OSGi standard.</p>

<p>The C Bundle Activator:</p>

<div class="codehilite"><pre><span></span><code><span class="c1">//${WS}/myproject/bundles/hello_world/private/src/hello_world_activator.c</span>
<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&quot;dm_activator.h&quot;</span><span class="cp"></span>


<span class="k">struct</span> <span class="n">userData</span> <span class="p">{</span>
        <span class="kt">char</span> <span class="o">*</span> <span class="n">word</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">celix_status_t</span> <span class="nf">dm_create</span><span class="p">(</span><span class="n">bundle_context_pt</span> <span class="n">context</span><span class="p">,</span> <span class="kt">void</span> <span class="o">**</span><span class="n">out</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">celix_status_t</span> <span class="n">status</span> <span class="o">=</span> <span class="n">CELIX_SUCCESS</span><span class="p">;</span>
    <span class="k">struct</span> <span class="n">userData</span><span class="o">*</span> <span class="n">result</span> <span class="o">=</span> <span class="n">calloc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">result</span><span class="p">));</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">result</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">result</span><span class="o">-&gt;</span><span class="n">word</span> <span class="o">=</span> <span class="s">&quot;C World&quot;</span><span class="p">;</span>
            <span class="o">*</span><span class="n">out</span> <span class="o">=</span> <span class="n">result</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">CELIX_START_ERROR</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">status</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">celix_status_t</span> <span class="nf">dm_init</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">userData</span><span class="p">,</span> <span class="n">bundle_context_pt</span> <span class="n">context</span><span class="p">,</span> <span class="n">dm_dependency_manager_pt</span> <span class="n">manager</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">struct</span> <span class="n">userData</span><span class="o">*</span> <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="k">struct</span> <span class="n">userData</span> <span class="o">*</span><span class="p">)</span> <span class="n">userData</span><span class="p">;</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Hello %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">-&gt;</span><span class="n">word</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">CELIX_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">celix_status_t</span> <span class="nf">dm_destroy</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">userData</span><span class="p">,</span> <span class="n">bundle_context_pt</span> <span class="n">context</span><span class="p">,</span> <span class="n">dm_dependency_manager_pt</span> <span class="n">manager</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">free</span><span class="p">(</span><span class="n">userData</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">CELIX_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<p>The C++ Bundle Activator (header + source):</p>

<div class="codehilite"><pre><span></span><code><span class="c1">//${WS}/myproject/bundles/HelloWorld/private/include/HelloWorldActivator.h</span>
<span class="cp">#ifndef HELLOWORLDACTIVATOR_H_</span>
<span class="cp">#define HELLOWORLDACTIVATOR_H_</span>

<span class="cp">#include</span> <span class="cpf">&quot;celix/dm/DmActivator.h&quot;</span><span class="cp"></span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">celix</span><span class="o">::</span><span class="n">dm</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">HelloWorldActivator</span> <span class="o">:</span> <span class="k">public</span> <span class="n">DmActivator</span> <span class="p">{</span>
<span class="k">private</span><span class="o">:</span>
    <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">word</span> <span class="p">{</span><span class="s">&quot;C++ World&quot;</span><span class="p">};</span> 
<span class="k">public</span><span class="o">:</span>
    <span class="n">HelloWorldActivator</span><span class="p">(</span><span class="n">DependencyManager</span><span class="o">&amp;</span> <span class="n">mng</span><span class="p">)</span> <span class="o">:</span> <span class="n">DmActivator</span> <span class="p">{</span><span class="n">mng</span><span class="p">}</span> <span class="p">{}</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="n">init</span><span class="p">();</span>
    <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">deinit</span><span class="p">();</span>
<span class="p">};</span>

<span class="cp">#endif </span><span class="c1">//HELLOWORLDACTIVATOR_H_</span>

<span class="c1">//${WS}/myproject/bundles/HelloWorld/private/src/HelloWorldActivator.cc</span>
<span class="cp">#include</span> <span class="cpf">&quot;HelloWorldActivator.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">celix</span><span class="o">::</span><span class="n">dm</span><span class="p">;</span>

<span class="n">DmActivator</span><span class="o">*</span> <span class="n">DmActivator</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="n">DependencyManager</span><span class="o">&amp;</span> <span class="n">mng</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">HelloWorldActivator</span><span class="p">(</span><span class="n">mng</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">HelloWorldActivator</span><span class="o">::</span><span class="n">init</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Hello &quot;</span> <span class="o">&lt;&lt;</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">word</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="n">HelloWorldActivator</span><span class="o">::</span><span class="n">deinit</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">//nothing to do</span>
<span class="p">}</span>
</code></pre></div>

<h3>Building</h3>

<p>One of the highly recommended features of CMake is the ability to do out of source builds, the benefit is that all of the build results will go in a separate directory without cluttering the (source) project.<br />
CMake also needs to able to find the cmake files Celix provides. This can be achieved by providing a CMAKE<em>MODULE</em>PATH variable (or setting the CMAKE<em>MODULE</em>PATH in the top level CMakeLists.txt).<br />
For this example it is assumed that Celix in installed in <code>/usr/local</code>.<br />
To create the build directory and build the project execute the following commands:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">cd</span> <span class="si">${</span><span class="nv">WS</span><span class="si">}</span>
mkdir myproject-build
<span class="nb">cd</span> myproject-build
cmake ../myproject
make all  
<span class="c1">#Or</span>
<span class="c1">#cmake -G Ninja ../myproject</span>
<span class="c1">#ninja</span>
</code></pre></div>

<p>Hopefully you will some some build results scrolling over the screen and actual build results in the build directory. There should be a hello<em>world.zip in the bundles/hello</em>world directory, this the actual bundle.<br />
A bundle on its own has no real value, so lets setup a deployment and run the Apache Celix framwork with these bundles.</p>

<h3>Running</h3>

<p>To create a deployment for the hello world bundles two things are needed: </p>

<ol>
<li>Add a <code>add_deploy</code> statement in the <code>CMakeLists.txt</code> file declaring what to deploy and under which name.</li>
</ol>

<div class="codehilite"><pre><span></span><code><span class="c">#${WS}/myproject/CMakeLists.txt</span>
<span class="nb">add_deploy</span><span class="p">(</span><span class="s">myproject</span> 
    <span class="s">BUNDLES</span> 
        <span class="o">${</span><span class="nv">CELIX_BUNDLES_DIR</span><span class="o">}</span><span class="s">/shell.zip</span> 
        <span class="o">${</span><span class="nv">CELIX_BUNDLES_DIR</span><span class="o">}</span><span class="s">/shell_tui.zip</span>
        <span class="o">${</span><span class="nv">CELIX_BUNDLES_DIR</span><span class="o">}</span><span class="s">/dm_shell.zip</span> 
        <span class="s">hello_world</span> <span class="c">#C bundle</span>
        <span class="s">HelloWorld</span> <span class="c">#C++ bundle</span>
<span class="p">)</span>       
</code></pre></div>

<p>Rerun make again form the build project. the make files generated by CMake will ensure cmake is run it again to update the actual make files.</p>

<div class="codehilite"><pre><span></span><code><span class="nb">cd</span> <span class="si">${</span><span class="nv">WS</span><span class="si">}</span>/myproject-build
make -j
<span class="c1">#or</span>
<span class="c1">#ninja</span>
</code></pre></div>

<p>Now a deploy directory myproject should be available in the deploy directory. This directory contains - among other files - a release.sh script. This can be used to setup the required environment variables (like LD<em>LIBRARY</em>PATH).</p>

<div class="codehilite"><pre><span></span><code><span class="nb">cd</span> <span class="si">${</span><span class="nv">WS</span><span class="si">}</span>/myproject-build/deploy/myproject
. ./release.sh
celix
<span class="c1">#or ./hello</span>
</code></pre></div>

<p>The hello<em>world bundle should be started with the famous "Hello World" text printed twice from the C and C++ bundle. The shell and shell</em>tui bundle are also deployed and these can be used to query and control the running framework. Below some commands are shown for querying the installed bundles, listing all known shell command, showing the help of a specific command and stopping a specific bundle (note that bundle 0 is the framework "bundle"):</p>

<pre><code>lb 
help
help inspect
stop 0
</code></pre>

<h2>Apache Celix Bundle Project in Eclipse</h2>

<p>A nice feature of CMake is the ability to generate Eclipse project files, with this feature bundles can also be developed with use of Eclipse. This should help speed up the development process.<br />
To get started change directory to the build directory and generate a eclipse project file.</p>

<pre><code>cd ${WS}/myproject-build 
cmake -G "Eclipse CDT4 - Unix Makefiles" .
</code></pre>

<p>Startup the Eclipse EDI and a chose the <code>${WS}</code></p>

<p><img src="getting_started_img1.png" alt="select workspace" /></p>

<p>Import the project with existing project. </p>

<p><img src="getting_started_img2.png" alt="import project" /></p>

<p>To build the project, use Project->Build All. To run or debug from Eclipse navigate to the myproject deploy directory and right click on the 'myproject-deploy.launch' file. And select Run As or Debug As to run or debug the bundle.</p>

<p><img src="getting_started_img3.png" alt="run project" /> </p>

<h2>Next</h2>

<p>The idea behind service oriented programming is that functionality is provided and used by abstract service, which hide implementation details.<br />
For a guide how to provide and use services see</p>

<ul>
<li><a href="using_services_with_c.md">Apache Celix - Getting Started Guide: Using Services with C</a></li>
<li><a href="using_services_with_cxx.md">Apache Celix - Getting Started Guide: Using Services with C++</a></li>
</ul>

</div></div><div id="foot">
<div id="footText">
Copyright © 2011 The Apache Software Foundation, Licensed under the Apache License, Version 2.0.
Apache Celix, Celix, Apache, the Apache feather logo and the Apache Celix logo are trademarks of The Apache Software Foundation. 
</div></div>
<script src='/import/javascript.js'></script>
